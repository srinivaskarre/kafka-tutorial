This tutorial has safe producer related code i.e., enabling idempotence, changing acks to all, max.inflight requests to 5 and retries to integer max value

and 

also added compression, linger.ms(wait for ms to batch the events/messages to be sent), compression to snappy